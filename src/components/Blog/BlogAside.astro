---
import type { CollectionEntry } from "astro:content";
import type { MarkdownHeading } from "astro";

import BlogAsideHeadings from "./BlogAsideHeadings.astro";
import BlogAsideSeriesItem from "./BlogAsideSeriesItem.astro";

export interface Props {
    headings: MarkdownHeading[];
    series?: CollectionEntry<"blog-series">;
    currentPost: string;
}

const { series, headings, currentPost } = Astro.props;
---

<style>
    .content-overview {
        @apply sticky;
        height: min-content;
    }
</style>

<aside
    class:list={[{ "pl-5": series, "pl-2": !series }]}
    class="unset top-5 content-overview"
>
    <ul class="unset list-none">
        {
            series &&
                series.data.posts.map((sp) => (
                    <BlogAsideSeriesItem
                        isCurrent={sp.post.slug === currentPost}
                        url={`/blog/${sp.post.slug}`}
                        label={sp.label}
                    >
                        <BlogAsideHeadings
                            headings={headings}
                            title={sp.label}
                            indentTitle={false}
                        />
                    </BlogAsideSeriesItem>
                ))
        }
        {
            !series && (
                <BlogAsideHeadings
                    headings={headings}
                    title="Auf dieser Seite:"
                />
            )
        }
    </ul>
</aside>
